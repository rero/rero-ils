[
  {
    "type": "fieldset",
    "title": "Patron",
    "items": [
      {
        "type": "flex",
        "flex-flow": "row wrap",
        "items": [
          {
            "key": "first_name",
            "htmlClass": "px-2"
          },
          {
            "key": "last_name",
            "htmlClass": "px-2"
          },
          {
            "key": "birth_date",
            "htmlClass": "px-2"
          }
        ]
      },
      {
        "type": "flex",
        "flex-flow": "row wrap",
        "items": [
          {
            "key": "street",
            "htmlClass": "px-2"
          },
          {
            "key": "postal_code",
            "htmlClass": "px-2"
          },
          {
            "key": "city",
            "htmlClass": "px-2"
          }
        ]
      },
      {
        "type": "flex",
        "flex-flow": "row wrap",
        "items": [
          {
            "key": "email",
            "htmlClass": "px-2"
          },
          {
            "key": "phone",
            "htmlClass": "px-2"
          }
        ]
      },
      {
        "type": "flex",
        "flex-flow": "row wrap",
        "items": [
          {
            "key": "roles",
            "htmlClass": "px-2"
          },
          {
            "key": "patron_type.$ref",
            "htmlClass": "px-2",
            "type": "select",
            "remoteRecordType": "patron_types",
            "condition": {
              "functionBody": "{return model.roles? model.roles.includes('patron'): false;}"
            }
          }
        ]
      },
      {
        "type": "flex",
        "flex-flow": "row wrap",
        "items": [
          {
            "key": "library.$ref",
            "htmlClass": "px-2",
            "type": "select",
            "remoteRecordType": "libraries",
            "condition": {
              "functionBody": "{return model.roles? model.roles.includes('librarian'): false;}"
            }
          },
          {
            "key": "barcode",
            "htmlClass": "px-2",
            "condition": {
              "functionBody": "{return model.roles? model.roles.includes('patron'): false;}"
            },
            "validationMessage": {
              "alreadyTakenMessage": "The barcode is already taken",
              "cannotBeVerifiedMessage": "The server cannot verify the barcode"
            },
            "remoteRecordType": "patrons"
          }
        ]
      }
    ]
  }
]