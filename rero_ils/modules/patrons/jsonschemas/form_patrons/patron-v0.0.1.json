[
  {
    "type": "fieldset",
    "title": "Personal data",
    "items": [
      {
        "key": "first_name",
        "htmlClass": "mr-2"
      },
      {
        "key": "last_name"
      },
      {
        "key": "birth_date",
        "description": "Use the selector or simply type in the input field."
      }
    ]
  },
  {
    "type": "fieldset",
    "title": "Address",
    "items": [
      {
        "key": "street"
      },
      {
        "key": "postal_code",
        "htmlClass": "flex-shrink-1 mr-2"
      },
      {
        "key": "city"
      }
    ]
  },
  {
    "type": "fieldset",
    "title": "Contacts",
    "items": [
      {
        "key": "email",
        "htmlClass": "mr-2"
      },
      {
        "key": "phone",
        "validationMessage": {
          "pattern": "Phone number with the international prefix, without spaces, ie +41221234567."
        }
      }
    ]
  },
  {
    "type": "fieldset",
    "items": [
      {
        "key": "roles",
        "title": "Roles",
        "type": "rolesCheckboxes",
        "orderable": "false",
        "titleMap": [
          {
            "value": "patron",
            "name": "patron"
          },
          {
            "value": "librarian",
            "name": "librarian"
          },
          {
            "value": "system_librarian",
            "name": "system librarian"
          }
        ]
      }
    ]
  },
  {
    "type": "fieldset",
    "condition": {
      "functionBody": "{return model.roles? true: false;}"
    },
    "items": [
      {
        "key": "barcode",
        "required": true,
        "condition": {
          "functionBody": "{return model.roles? model.roles.includes('patron'): false;}"
        },
        "validationMessage": {
          "alreadyTakenMessage": "The barcode is already taken",
          "cannotBeVerifiedMessage": "The server cannot verify the barcode"
        },
        "remoteRecordType": "patrons"
      },
      {
        "key": "patron_type.$ref",
        "required": true,
        "title": "Patron Type",
        "description": "Patron type in term of circulation policy.",
        "type": "select",
        "remoteRecordType": "patron_types",
        "condition": {
          "functionBody": "{return model.roles? model.roles.includes('patron'): false;}"
        }
      },
      {
        "key": "library.$ref",
        "required": true,
        "title": "Library",
        "description": "Library affiliation.",
        "type": "select",
        "remoteRecordType": "libraries",
        "remoteRecordFiltersByOwningLibrary": "pid",
        "condition": {
          "functionBody": "{return model.roles? model.roles.includes('librarian'): false;}"
        }
      }
    ]
  },
  {
    "type": "fieldset",
    "condition": {
      "functionBody": "{ return model.roles? model.roles.includes('patron'): false; }"
    },
    "items": [
      {
        "key": "communication_channel",
        "required": true,
        "titleMap": [
          {
            "value": "email",
            "name": "Email"
          },
          {
            "value": "mail",
            "name": "Mail"
          }
        ],
        "placeHolder": "Select\u2026"
      },
      {
        "key": "communication_language",
        "required": true,
        "type": "select",
        "titleMap": [
          {
            "name": "English",
            "value": "eng"
          },
          {
            "name": "French",
            "value": "fre"
          },
          {
            "name": "German",
            "value": "ger"
          },
          {
            "name": "Italian",
            "value": "ita"
          }
        ],
        "placeHolder": "Select\u2026"
      }
    ]
  }
]
