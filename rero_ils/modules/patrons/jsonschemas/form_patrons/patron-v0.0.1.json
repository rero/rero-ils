[
  {
    "type": "fieldset",
    "title": "Personal data",
    "items": [
      {
        "type": "flex",
        "flex-direction": "row",
        "items": [
          {
            "key": "first_name",
            "htmlClass": "mr-2"
          },
          {
            "key": "last_name"
          }
        ]
      },
      {
        "key": "birth_date",
        "description": "Use the selector or simply type in the input field."
      }
    ]
  },
  {
    "type": "fieldset",
    "title": "Address",
    "items": [
      {
        "key": "street"
      },
      {
        "type": "flex",
        "flex-direction": "row",
        "items": [
          {
            "key": "postal_code",
            "htmlClass": "flex-shrink-1 mr-2"
          },
          {
            "key": "city"
          }
        ]
      }
    ]
  },
  {
    "type": "fieldset",
    "title": "Contacts",
    "items": [
      {
        "type": "flex",
        "flex-direction": "row",
        "items": [
          {
            "key": "email",
            "htmlClass": "mr-2"
          },
          {
            "key": "phone"
          }
        ]
      }
    ]
  },
  {
    "type": "fieldset",
    "title": "Roles",
    "items": [
      {
        "type": "flex",
        "flex-direction": "row",
        "items": [
          {
            "key": "roles",
            "notitle": "true",
            "type": "rolesCheckboxes",
            "htmlClass": "d-inline-block",
            "orderable": "false",
            "titleMap": [
              {
                "value": "patron",
                "name": "patron"
              },
              {
                "value": "librarian",
                "name": "librarian"
              },
              {
                "value": "system_librarian",
                "name": "system librarian"
              }
            ]
          },
          {
            "type": "fieldset",
            "items": [
              {
                "key": "barcode",
                "required": true,
                "condition": {
                  "functionBody": "{return model.roles? model.roles.includes('patron'): false;}"
                },
                "validationMessage": {
                  "alreadyTakenMessage": "The barcode is already taken",
                  "cannotBeVerifiedMessage": "The server cannot verify the barcode"
                },
                "remoteRecordType": "patrons"
              },
              {
                "key": "patron_type.$ref",
                "required": true,
                "title": "Patron Type",
                "description": "Patron type in term of circulation policy.",
                "type": "select",
                "remoteRecordType": "patron_types",
                "condition": {
                  "functionBody": "{return model.roles? model.roles.includes('patron'): false;}"
                }
              },
              {
                "key": "library.$ref",
                "required": true,
                "title": "Library",
                "description": "Library affiliation.",
                "type": "select",
                "remoteRecordType": "libraries",
                "remoteRecordFiltersByOwningLibrary": "pid",
                "condition": {
                  "functionBody": "{return model.roles? model.roles.includes('librarian'): false;}"
                }
              }
            ]
          }
        ]
      },
      {
        "type": "flex",
        "flex-flow": "row wrap",
        "items": [
          {
            "key": "communication_channel",
            "required": true,
            "htmlClass": "px-2",
            "titleMap": {
              "email": "Email",
              "mail": "Mail"
            },
            "placeHolder": "Select\u2026",
            "condition": {
              "functionBody": "{ return model.roles? model.roles.includes('patron'): false; }"
            }
          },
          {
            "key": "communication_language",
            "required": true,
            "htmlClass": "px-2",
            "type": "select",
            "titleMap": {
              "eng": "English",
              "fre": "French",
              "ger": "German",
              "ita": "Italian"
            },
            "placeHolder": "Select\u2026",
            "condition": {
              "functionBody": "{ return model.roles? model.roles.includes('patron'): false; }"
            }
          }
        ]
      }
    ]
  }
]
